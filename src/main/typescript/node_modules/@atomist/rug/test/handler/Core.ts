import {ScenarioWorld} from "../ScenarioWorld"
import {Result} from "../Result"

/**
 * Subinterface of ScenarioWorld specific to 
 * scenarios testing project operations
 */
export interface HandlerScenarioWorld extends ScenarioWorld {
    
    /**
     * Return the CommandHandler with the given name, or null if none is found.
     * Pass to invokeHandler
     */
    commandHandler(name: string): any
    
    eventHandler(name: string): any

    /**
     * Execute the given handler, validating parameters
     */
    invokeHandler(commandHandler: any, params?: {})
}
 
interface Definitions {

    Given(s: string, f: (Project, HandlerScenarioWorld?) => void): void

    When(s: string, f: (Project, HandlerScenarioWorld?) => void): void

    Then(s: string, f: (Project, HandlerScenarioWorld?) => Result | boolean): void
    
}

 // Registered with Nashorn by the test runner
declare var com_atomist_rug_test_gherkin_GherkinRunner$_definitions: Definitions

export function Given(s: string, f: (Project, HandlerScenarioWorld?) => void) { 
    com_atomist_rug_test_gherkin_GherkinRunner$_definitions.Given(s, f) 
}

export function When(s: string, f: (Project, HandlerScenarioWorld?) => void) { 
    com_atomist_rug_test_gherkin_GherkinRunner$_definitions.When(s, f) 
}

export function Then(s: string, f: (Project, HandlerScenarioWorld?) => Result | boolean) { 
    com_atomist_rug_test_gherkin_GherkinRunner$_definitions.Then(s, f) 
}

// Import well-known step definitions. It's nicer
// to have them in a separate file.
import "./WellKnownSteps.js"
